<!DOCTYPE html>
<html>
<head>
    <title>File Info Static Analyst</title>
</head>
<body>
    <a href="http://localhost:5000/dynamic" target="_blank">
        <input type="button" value="Dynamic Analyst">
    </a>
    <h1>File Info</h1>
    <p><strong>File Name:</strong> {{ filename }}</p>
    <p><strong>Size:</strong> {{ size }} MB</p>
    <p><strong>MD5:</strong> {{ md5 }}</p>
    <h1>Certificate information</h1>
    <pre>{{ data_cert['certificate_info'] }}</pre>
    <h2>Warning</h2>
    <ul>
        {% for finding in data_cert['certificate_findings'] %}
            <li><strong>{{ finding[2] }}</strong>: {{ finding[1] }}</li>
        {% endfor %}
    </ul>
    <!-- permission analyst -->
    <h1>Application Information</h1>
    <p><strong>Package Name:</strong> {{ data_permission['packagename'] }}</p>
    <p><strong>Main Activity:</strong> {{ data_permission['mainactivity'] }}</p>
    <p><strong>Min SDK Version:</strong> {{ data_permission['min_sdk'] }}</p>
    <!-- Thông perm dưới dạng bảng -->
    <h2>Check Application Permission</h2>
    <table border="1">
        <tr>
            <th>Permission</th>
            <th>Security level</th>
            <th>Infomation</th>
            <th>Description</th>
        </tr>
        {% for permission, info in data_permission['perm'].items() %}
            <tr>
                <td>{{ permission }}</td>
                <td>{{ info[0] }}</td>
                <td>{{ info[1] }}</td>
                <td>{{ info[2] }}</td>
            </tr>
        {% endfor %}
    </table>
    <!-- Hiển thị các thông tin khác tùy ý -->
    <h2>The Activities of application:</h2>
    <ul>
        {% for activity in data_permission['activities'] %}
            <li>{{ activity }}</li>
        {% endfor %}
    </ul>

    <!-- application analyst -->
    <h1>Check Manifest Application:</h1>
    <table border="1">
        <tr>
            <th>Rule</th>
            <th>Title</th>
            <th>Severity</th>
            <th>Description</th>
            <th>Name</th>
            <th>Component</th>
        </tr>
        {% for item in data_application %}
        <tr>
            <td>{{ item.rule }}</td>
            <td>{{ item.title }}</td>
            <td>{{ item.severity }}</td>
            <td>{{ item.description }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.component }}</td>
        </tr>
        {% endfor %}
    </table>

    <!-- exported analyst -->
    <h1>Activities that can be activated</h1>
    <table border="1">
        <tr>
            <th>Activity Name</th>
        </tr>
        {% for activity in data_exported %}
        <tr>
            <td>{{ activity }}</td>
        </tr>
        {% endfor %}
    </table>
    <a href="http://localhost:5000/download" target="_blank">
        <input type="button" value="Exported Report PDF ">
    </a>
</body>
</html>
